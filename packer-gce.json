{
  "variables": {
    "namesuffix": "{{env `IMAGE_NAME_SUFFIX`}}",
    "version": "0.9",
    "account_file": "{{env `GCE_ACCOUNT_FILE`}}",
    "image_name": "cb-centos71-amb210-{{ isotime \"2006-01-02\" }}{{env `IMAGE_NAME_SUFFIX`}}"
  },
  "builders":[{
    "disk_size": "40",
    "name": "us-central1-b",
    "type": "googlecompute",
    "account_file": "{{user `account_file`}}",
    "source_image": "centos-7-v20150603",
    "zone": "us-central1-b",
    "project_id": "siq-haas",
    "ssh_username": "centos",
    "machine_type": "n1-standard-2",
    "image_name": "{{user `image_name`}}",
    "tags": [
	"packer"
    ]
  }],
  "provisioners": [{
    "type": "file",
    "source": "scripts/",
    "destination": "/tmp"
  },
  {
    "type": "shell",
    "script": "./user-data-script.sh",
    "execute_command": "chmod +x {{ .Path }}; {{ .Vars }} sudo -E bash '{{ .Path }}'"
  },
  {
    "type": "shell",
    "script": "./optimization-script-for-hdp.sh",
    "execute_command": "chmod +x {{ .Path }}; {{ .Vars }} sudo -E bash '{{ .Path }}'"
  },
  {
    "type": "shell",
    "script": "./create-gc-image.sh",
    "execute_command": "chmod +x {{ .Path }}; {{ .Vars }} PACKER_IMAGE_NAME={{user `image_name`}} sudo -E bash '{{ .Path }}'"
  }]
}
